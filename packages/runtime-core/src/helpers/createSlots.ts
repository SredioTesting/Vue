import { Slot } from '../componentSlots'
import { isArray } from '@vue/shared'

interface CompiledSlotDescriptor {
  name: string
  fn: Slot
}

export function createSlots(
  slots: Record<string, Slot>,
  dynamicSlots: (CompiledSlotDescriptor | CompiledSlotDescriptor[])[]
): Record<string, Slot> {
  for (const slot of dynamicSlots) {
    const array = isArray(slot) ? 
      // array of dynamic slot generated by <template v-for="..." #[...]>
      slot : 
      // conditional single slot generated by <template v-if="..." #foo>
      [slot]
    
    for (const {name, fn} of array) {
      slots[name] = fn
    }
  }
  return slots
}
